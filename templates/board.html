<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Türk Daması</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <script>
        const initialGameState = {{ game_state | tojson | safe }};
    </script>
</head>
<body>
    <div class="page-container">
        <!-- Oyun Tahtası Alanı -->
        <div class="board-area">
            <div id="player-info-top" class="player-info-box">
                <span class="player-name">Rakip</span>
                <span class="player-clock">10:00</span>
            </div>
            <div id="board-container">
                <div class="coordinates files">
                    <span>a</span><span>b</span><span>c</span><span>d</span><span>e</span><span>f</span><span>g</span><span>h</span>
                </div>
                <div class="coordinates ranks">
                    <span>8</span><span>7</span><span>6</span><span>5</span><span>4</span><span>3</span><span>2</span><span>1</span>
                </div>
                <div id="board"></div>
                <div id="arrow-container"></div>
            </div>
            <div id="player-info-bottom" class="player-info-box">
                <span class="player-name">Siz</span>
                <span class="player-clock">10:00</span>
            </div>
        </div>

        <!-- Oyun Kontrol Paneli -->
        <div class="game-panel">
            <h1 class="panel-title">Türk Daması Oyna</h1>
            <div class="panel-tabs">
                <button class="tab-button active" data-tab="new-game-tab">Yeni Oyun</button>
                <button class="tab-button" data-tab="analysis-tab">Analiz</button>
                <!-- YENİ: Debug Sekmesi -->
                <button class="tab-button" data-tab="debug-tab">Debug</button>
            </div>

            <div id="new-game-tab" class="tab-content active">
                <form action="{{ url_for('start') }}" method="POST" id="new-game-form">
                    <div class="game-type-selector">
                        <button type="button" class="game-type-btn {{ 'active' if mode == 'pve' else '' }}" data-mode="pve">Bilgisayara Karşı</button>
                        <button type="button" class="game-type-btn {{ 'active' if mode == 'pvp' else '' }}" data-mode="pvp">Arkadaşınla Oyna</button>
                        <input type="hidden" name="mode" id="game-mode-input" value="{{ mode | default('pve') }}">
                    </div>

                    <div class="time-control-wrapper {{ 'hidden' if mode != 'pvp' }}">
                         <svg class="time-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg>
                         <select id="time-control-select" name="time_control">
                            <option value="600_0">10 Dakika</option>
                            <option value="300_3">5 | 3</option>
                            <option value="180_2">3 | 2</option>
                            <option value="60_1">1 | 1</option>
                            <option value="unlimited">Sınırsız</option>
                        </select>
                    </div>
                    
                    <div class="difficulty-slider-wrapper {{ 'hidden' if mode != 'pve' }}">
                        <label for="difficulty-slider">Zorluk Seviyesi: <strong id="difficulty-value">50</strong></label>
                        <input type="range" min="1" max="100" value="50" id="difficulty-slider" name="difficulty">
                    </div>
                    
                    <button type="submit" class="start-game-btn">Oyunu Başlatın</button>
                </form>
            </div>
            
            <div id="analysis-tab" class="tab-content">
                 <div class="engine-analysis-panel">
                    <h2>Motor Değerlendirmesi</h2>
                    <div class="evaluation-bar-container">
                        <div id="evaluation-bar" class="evaluation-bar"></div>
                    </div>
                    <div id="evaluation-score" class="evaluation-score">+0.00</div>
                    <div>
                        <h3>En İyi Hamleler</h3>
                        <ul id="engine-lines" class="engine-lines">
                            <li class="loading-line">Analiz için hamle yapın...</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- YENİ: Debug Sekmesi İçeriği -->
            <div id="debug-tab" class="tab-content">
                <div class="debug-panel">
                    <h2>Hata Ayıklama Aracı</h2>
                    <div class="debug-section">
                        <h3>Oyun Durumu (GameState)</h3>
                        <pre id="debug-game-state"></pre>
                    </div>
                    <div class="debug-section">
                        <h3>Test Butonları</h3>
                        <button id="debug-test-animation">Animasyon Testi (e2-e4)</button>
                    </div>
                    <div class="debug-section">
                        <h3>Loglar</h3>
                        <div id="debug-log" class="debug-log-area"></div>
                    </div>
                </div>
            </div>

             <div id="game-info">
                <p class="message" id="message-area"></p>
            </div>
            <div class="navigation-controls">
                <button id="nav-start" class="button nav-button" title="İlk Hamle">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="19 20 9 12 19 4 19 20"></polygon><line x1="5" y1="19" x2="5" y2="5"></line></svg>
                </button>
                <button id="nav-prev" class="button nav-button" title="Önceki Hamle">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="15 18 9 12 15 6"></polyline></svg>
                </button>
                <button id="nav-next" class="button nav-button" title="Sonraki Hamle">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="9 18 15 12 9 6"></polyline></svg>
                </button>
                <button id="nav-end" class="button nav-button" title="Son Hamle">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="5 4 15 12 5 20 5 4"></polygon><line x1="19" y1="5" x2="19" y2="19"></line></svg>
                </button>
            </div>
        </div>

        <!-- Hamle Notasyon Paneli -->
        <div class="notation-panel">
            <h2>Hamleler</h2>
            <div id="notation-list-container">
                <!-- Hamle listesi JavaScript tarafından buraya eklenecek -->
            </div>
        </div>
    </div>
    <script src="{{ url_for('static', filename='js/main.js') }}" type="module"></script>
</body>
</html>
